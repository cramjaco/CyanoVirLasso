# Methods
To explore thestatistical interactions between viruses and cyanobacterial groups,we generated statistical association networks using a variation onthe graphical lasoo approach (REF). In this approach used lassooregression to identify which cyanobacteria and environmentalparameters predicted the abundance of each different viral gene.However, our method differed from graphical lasso in that it did notexplore associations between different viral genes nor betweencyanobacterial groups.
To carry out thisanalysis, two matrices were generated. Matrix **X** containedthe normalized abundances of all cyanobacterial reads, as well as thevalues of a suite of a suite of environmental and locationparameters. Environmental parameters were: temperature, salinity,oxygen concentration, nitrate, nitrite, phosphate. Locationparameters were binary dummy variables corresponding to the oceanregion in which the sample was collected. They included the followinggeographic regions: East and West and Central North Atlantic, Easter Tropical North and South Pacific Oceans. Location variablesalso indicated whether the sample was collected within a DeepChlorophyll Maximum, the mesopelegic (200-1000m), hypoxic (define),suboxic (define), or oxygen deficient zone waters (Undetectable O2).Matrix **Y**contained the abundance of a suite of viral genes (tell the readerwhat these have in common and maybe some more information here).We used the glmnetpackage in R to perform lasso regressions using all variables in thematrix **X** to predict each variable in **Y**. Lasso requiresspecification of a tuning parameter, *λ*. We identified a single *λ*value that optimized the predictive capability of the approach. Toidentify predictive capability, we used a ten-fold cross validationapproach to minimize residual mean squared error of our predictions.In this approach the data were split into ten even separate chunks.In an iterative process each chunk was held out as test data, themodel was trained on the remaining nine chunks. The performance of themodel at predicting the test data was calculated by averaging theresidual mean squared error (RMSE) of model predictions for eachvariable in **Y**, given the matrix **X** a given value of *λ*. Wethen used the `optimize()` function in `R`'s `stats` package toidentify the lambda value associated with the lowest,cross-validated, combined RMSE.We recorded which variables were kept by the lasso approach, and by theirrelative penalized coefficients. We visualized the results of thelasso regressions using the `igraph` package in R to show whichviruses were statistically associated with each cyanobacterial host.We removed the environmental nodes from the visualization, but notthe calculations, in order to allow the lasso to account for andfactor out associations between viral genes and regions andenvironmental conditions.
# Results
Association networksindicated that some viral genes were associated with particularcyanobacterial ecotypes. The strongest statistical associations werebetween...
# Figures
Figure X. A lassobased association network between different cyanobacterial ecotypesand viral genes. Nodes indicate viral gene abundances (whitesquares), and cyanobacterial host abundances (green circles). Edgesconnect viral and cyanobacterial nodes that are statisticallyassociated. Relative edge thickness relates to the relativecoefficients of the lasso regressions, with thicker edges associatingwith stronger statistical associations. Environmental and locationdata were used to generate this network in order to factor out thosevariables, but those nodes and their associated edges are not shownto reduce complexity and to focus on the virus to host associations.